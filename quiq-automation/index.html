<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Quiq Ticketer</title>
    <link rel="stylesheet" href="css/general.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/main.css">
</head>

<body>
    <header>
        <h1 id="header">Quiq Ticketer Program</h1>
        <a href="../index.html">BSC Projects</a>
    </header>
    <nav>
        <br>
        <a class="nav-link active" href="#header">Top &uarr;</a>
        <h3 class="nav-heading">Introduction</h3>
        <a class="nav-link" href="#technologies">Technologies</a>
        <a class="nav-link" href="#setup">Setup</a>
        <h3 class="nav-heading">Prerequisties</h3>
        <a class="nav-link" href="#concepts">Concepts</a>
        <h3 class="nav-heading">Overview</h3>
        <a class="nav-link" href="#controller">Controller</a>
        <a class="nav-link" href="#execution">Execution</a>
        <a class="nav-link" href="#errors">Errors</a>
        <a class="nav-link" href="#npes">NPEs</a>
        <a class="nav-link" href="#logging">Logging</a>
        <a class="nav-link" href="#debugging">Debugging</a>
        <h3 class="nav-heading">Creating the Ticket</h3>
        <a class="nav-link" href="#building">Building</a>
        <h3 class="nav-heading">Classes</h3>
        <a class="nav-link" href="#application">Application</a>
        <h3 class="nav-heading">External Resources</h3>
        <a class="nav-link" href="https://td.byui.edu/TDWebApi/" target="_blank">TeamDynamix Web API</a>
        <a class="nav-link" href="https://start.spring.io/" target="_blank">Spring Initializr</a>
        <a class="nav-link" href="https://gradle.org/install/" target="_blank">Gradle</a>
        <a class="nav-link" href="https://byui.goquiq.com/api/docs" target="_blank">Quiq API</a>
        <a class="nav-link" href="https://www.jetbrains.com/idea/" target="_blank">IntelliJ IDEA</a>
        <a class="nav-link" href="https://devcenter.heroku.com/articles/heroku-cli" target="_blank">Heroku</a>
    </nav>
    <main>
        <h1 class="content-heading">Introduction</h1>
        <hr>
        <h2 class="content-section" id="technologies">Technologies</h2>
        <p>The Quiq Ticketer program is a Java web server that utilizes the <a href="https://spring.io/guides/gs/spring-boot/" target="_blank">Spring Boot</a> framework.
            The Spring Boot framework was chosen because of its simplicity, ease of use for initializing web servers, and compatability with Heroku.</p>
        <p>The build tool used for this program is <a href="https://gradle.org/" target="_blank">Gradle</a>. Gradle was chosen over 
            <a href="https://maven.apache.org/" target="_blank">Maven</a> as the build tool because of its simplicity of use and since 
            it generally builds projects faster than Maven.</p> <p>The code is stored on <a href="https://github.com/" target="_blank">Github</a> and then deployed on <a
                href="https://heroku.com" target="_blank">Heroku</a>.</p>
        <h2 class="content-section" id="setup">Setup</h2>
        <p>In order to work on this project, You will need to install a few things:</p>
        <ul>
            <li><a href="https://www.jetbrains.com/idea/" target="_blank">IntelliJ Ultimate</a> 
                (apply for a <a href="https://www.jetbrains.com/community/education/#students" target="_blank">free educational license</a> as a student)</li>
            <li><a href="https://git-scm.com/downloads" target="_blank">Git</a></li>
            <li><a href="https://www.oracle.com/java/technologies/java-archive-javase10-downloads.html" target="_blank">Java 10 JDK</a> (or newer)</li>
            <li><a href="https://gradle.org/install/" target="_blank">Gradle</a> (follow the tutorial)</li>
            <li><a href="https://devcenter.heroku.com/articles/heroku-cli" target="_blank">Heroku CLI</a></li>
            <li>Environment variables (ask other employees about necessary <code>env vars</code> for this program)</li>
            <li><a href="https://www.postman.com/downloads/" target="_blank">Postman</a> (very helpful for testing purposes)</li>
        </ul>
        <p>Once you have those things, you will need to add yourself as a collaborator to the project on Github and then
            you can clone it onto your local machine. From there you can do whatever you need to do. <b>Make sure to put your proposed changes on a separate branch!</b></p>
        <h1 class="content-heading">Prerequisties</h1>
        <hr>
        <h2 class="content-section" id="concepts">Concepts</h2>
        <p>Before proceeding to the inner workings of the program, review the following concepts in case you are unfamiliar with them.</p>
        <ul>
            <li><a href="https://en.wikipedia.org/wiki/Java_%28programming_language%29" target="_blank">Java programming</a> 
                (especially the <a href="https://en.wikipedia.org/wiki/Java_%28programming_language%29#Execution_system" target="_blank">execution system</a> section)</li> 
            <li><a href="https://developers.goquiq.com/api/docs#operation/Webhook%20-%20ConversationStatusChanged" target="_blank">Quiq ConversationStatusChanged</a> 
                webhook data object</li>
                <li><a href="https://en.wikipedia.org/wiki/Object-oriented_programming" target="_blank">Object-Orientated Programming</a> (OOP)</li> 
            <li><a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank">REST architecture</a></li> 
            <li><a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller" target="_blank">MVC architecture</a></li> 
            <li><a href="https://en.wikipedia.org/wiki/Webhook" target="_blank">Webhooks</a></li> 
            <li><a href="https://gitimmersion.com/lab_01.html" target="_blank">Git</a> (tutorial/labs)</li> 
            <li><a href="https://en.wikipedia.org/wiki/Test-driven_development" target="_blank">Test Driven Development</a>  (TDD)</li> 
            <li><a href="https://www.tutorialspoint.com/java/java_multithreading.htm" target="_blank">Multithreading in Java</a></li>
            <li><a href="https://en.wikipedia.org/wiki/JSON" target="_blank">JSON</a></li> 
            <li><a href="https://en.wikipedia.org/wiki/Application_programming_interface" target="_blank">Application Programming Interface</a> (API)</li> 
            <li><a href="https://en.wikipedia.org/wiki/Continuous_delivery" target="_blank">Continuous Delivery</a></li>
            <li><a href="https://en.wikipedia.org/wiki/Software_framework" target="_blank">Software Frameworks</a></li> 
            <li><a href="https://en.wikipedia.org/wiki/Unix_time" target="_blank">Unix time</a></li> 
        </ul>
        <h1 class="content-heading">Overview</h1>
        <hr>
        <h2 class="content-section" id="controller">Ticketer Controller</h2>
        <p>The <code>TicketerController</code> class behaves as the controller from the 
            <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller" target="_blank">MVC</a> architecture.
             The Java annotation <code>@PostMapping("/")</code> denotes that the <code>postRequest()</code> function listens for <code>POST</code>
             web traffic coming from the default route (i.e. <code>"/"</code>).</p> 
        <p class="tip">For clarity, the model includes classes that manipulate data (i.e. <code>QuiqParser</code> and <code>TicketHandler</code> classes). 
            The view is simply the returned string (i.e. <code>"Thanks"</code> or <code>"No Thanks"</code>).</p>
        <p>Once recieved, the <code>POST</code> request is authenticated by checking the value of the secret Quiq header token.</p>
        <p>After authenticating, a new thread is created to asynchronously run the program.</p>
        <p class="tip">
            Quiq has a timeout limit. If that limit is reached, Quiq will retry the request with an 
            exponentional back off. If the program ran synchronously, then there is a risk the Quiq timeout limit would be reached. 
            This is why it is necessary to execute the program asynchronously (via a thread).
            See the <a href="https://developers.goquiq.com/api/docs#section/Webhooks-Overview" target="_blank">Quiq Webhooks Overview</a>
            for more information about how Quiq handles errors.
        </p>
        <p>The program's flow of execution:</p>
        <ul>
            <li>Authentication with TeamDynamix (login)</li>
            <li>Parsing the <code>QuiqConversationData</code> object into a <code>TeamDynamixData</code> object (via the <code>QuiqParser</code> class)</li>
            <li>Building the TeamDynamix ticket from the <code>TeamDynamixData</code> object via the <code>TicketHandler</code> class</li>
            <li>Creating the ticket in TeamDynamix</li>
        </ul>
        <h2 class="content-section" id="execution">Running vs. Executing the Program</h2>
        <p>Running and executing the program are <b>NOT</b> the same thing. Running the program means the program will start <i>listening</i> for web traffic. 
            Executing the program means to <i>send data</i> to the endpoint that the program is listening on.</p>
        <p>The program can be <i>ran</i> in several different ways:</p>
        <ul>
            <li>Running the <code>.jar</code> file from the command line 
                <p class="tip">Execute the following command: <code>java -jar &lt;path-to-jar&gt;</code>. 
                    The .jar file is typically found in the <code>build/libs</code> directory.</p></li>
            <li>Running the <code>TicketerApplication</code> in IntelliJ</li>
        </ul>
        <p>The program can be <i>executed</i> in several different ways:</p>
        <ul>
            <li>Executing the program from the command line
                <p class="tip">Use the <a href="https://www.tutorialspoint.com/unix_commands/curl.htm" target="_blank">curl</a> command.
                (i.e. <code>curl -X POST localhost:8080/</code>)</p></li>
            <li>Execute the program via <a href="https://www.postman.com/" target="_blank">Postman</a>
            <p class="tip">This is the preferred method since it is much easier to specify the <code>POST</code> body.</p></li>
        </ul>
        <h2 class="content-section" id="errors">Errors</h2>
        <p>Errors are thrown and caught by the program via the <code>TD Exception</code> class.</p>
        <p>There are two different implications of a thrown error depending on how it is caught:</p>
        <ul>
            <li>Caught by <code>TicketerController</code> class: error is unrecoverable and no ticket will be created.</li>
            <li>Caught within thrown function: error is recoverable and a ticket will still be created.</li>
        </ul>
        <p>Make sure you understand the implications and repercusions of both methods and use them appropriately.</p>
        <h2 class="content-section" id="npes">Null Pointer Exceptions (NPEs)</h2>
        <p>Inside the <code>QuiqParser</code> class, for example, there is a lot of <code>NULL</code> checking. This is necessary because it is not
        known at runtime what webhook data will be populated or not.</p>
        <p>For example, the <code>QuiqConversationData</code> object has a <code>custom map</code>. Depending on the incoming webhook data, this <code>map</code>
        may or may not exist. Therefore it is necessary to ensure it's non-null before deferencing it (retrieving a value from a key). This <code>NULL</code>
        checking is a bit gratuitous but necessary to ensure that an NPE does not occurr. NPEs result in live chat tickets not being created, so a minor trade-off
        in readability for a bit more security is almost always worth it.</p>
        <h2 class="content-section" id="logging">Logging</h2>
        <p>Wherever an exception is caught, there should be an instance of the 
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/logging/Logger.html" target="_blank">Java Logger</a> class present.
            Inside the catch clause, the logger class should log a message with the appropriate 
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/logging/Level.html" target="_blank">logging level</a> (typically <code>WARNING</code>
            for errors).
        </p>
        <h2 class="content-section" id="debugging">Debugging</h2>
        <p>If you need to debug the program, please use IntelliJ's built-in 
            <a href="https://www.jetbrains.com/help/idea/debugging-code.html" target="_blank">debugger</a>. Set 
            <a href="https://www.jetbrains.com/help/idea/using-breakpoints.html" target="_blank">breakpoints</a>
            in various sections of the code and use print statements to find where errors are occurring.</p>
        <p>Once an error has been found, fix the code and write a test to assert that the error will not occur again.</p>
        <h1 class="content-heading">Creating the Ticket</h1>
        <hr>
        <h2 class="content-section" id="building">QuiqParser</h2>
        <p>After retrieving and authenticating the request, the data is sent through <code>QuiqParser</code> class to extract the necessary data.</p>
        <h3>getTeamDynamixData()</h3>
        <p>Takes the <code>QuiqConversationData</code> and extracts/manipulates the necessary information needed to build a TeamDynamix ticket.
        However, a <code>TeamDynamixData</code> object is returned, <b>NOT</b> a TeamDynamix ticket. This is because, depending on the type of ticket,
        additional information from TeamDynamix needs to be retrieved to build the actual ticket.</p>
        <p class="tab"><i>Returns: <code>TeamDynamixData</code></i></p>
        <p class="tip">Essentially the driver method for the class.</p>
        <h3>initializeTeamDynamixData()</h3>
        <p>According to the department, initialize the associated <code>TeamDynamixData</code> subclass.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>teamDynamix</code></td>
                    <td>TeamDynamix</td>
                    <td>Used to initialize <code>TeamDynamixData</code> subclasses since some of them need to make calls to the TeamDynamix API.</td>
                </tr>
                <tr>
                    <td><code>department</code></td>
                    <td>enum</td>
                    <td>One of the enumerated departments used to determine which <code>TeamDynamixData</code> subclass to initialize.</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: <code>TeamDynamixData</code></i></p>
        <h3>getFirstName()</h3>
        <p>Retrieves the customer's first name if it exists. Otherwise, an empty string is returned.</p>
        <p class="tab"><i>Returns: String</i></p>
        <h3>getLastName()</h3>
        <p>Retrieves the customer's last name if it exists. Otherwise, an empty string is returned.</p>
        <p class="tab"><i>Returns: String</i></p>
        <h3>getRequestorEmail()</h3>
        <p>Retrieves the customer's email address if it exists. Otherwise, an empty string is returned.</p>
        <p class="tab"><i>Returns: String</i></p>
        <h1 class="content-heading">Classes</h1>
        <hr>
        <h2 class="content-section" id="application">Application</h2>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>agentName</code></td>
                    <td>String</td>
                    <td>The name of the Agent.</td>
                </tr>
                <tr>
                    <td><code>isLvl2</code></td>
                    <td>Boolean</td>
                    <td>Whether the converstation needs to be sent to Level 2 or not.</td>
                </tr>
                <tr>
                    <td><code>type</code></td>
                    <td>Number</td>
                    <td>The TypeID for the ticket.</td>
                </tr>
                <tr>
                    <td><code>form</code></td>
                    <td>Number</td>
                    <td>What form the ticket shold be put into.</td>
                </tr>
                <tr>
                    <td><code>status</code></td>
                    <td>Number</td>
                    <td>The StatusID for the ticket.</td>
                </tr>
                <tr>
                    <td><code>id</code></td>
                    <td>Number</td>
                    <td>The application id (AppID).</td>
                </tr>
            </tbody>
        </table>
        <h3>Constructor</h3>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>agentName</code></td>
                    <td>String</td>
                    <td>The name of the Agent</td>
                </tr>
                <tr>
                    <td><code>isLvl2</code></td>
                    <td>Boolean</td>
                    <td>Whether the converstation needs to be sent to Level 2 or not.</td>
                </tr>
            </tbody>
        </table>
        <h3>addCustomAttribute()</h3>
        <p>Adds a custom attribute to the array of attributes.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>id</code></td>
                    <td>Number</td>
                    <td>The ID of the attribute to be added.</td>
                </tr>
                <tr>
                    <td><code>value</code></td>
                    <td>Number | String</td>
                    <td>The Value that should be represented in the attribute.</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>SetRequiredAttributes()</h3>
        <p>Sets some of the required attributes that are application specific.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>type</code></td>
                    <td>Number</td>
                    <td>The TypeID for the ticket.</td>
                </tr>
                <tr>
                    <td><code>form</code></td>
                    <td>Number</td>
                    <td>What form the ticket shold be put into.</td>
                </tr>
                <tr>
                    <td><code>status</code></td>
                    <td>Number</td>
                    <td>The StatusID for the ticket.</td>
                </tr>
                <tr>
                    <td><code>id</code></td>
                    <td>Number</td>
                    <td>The application id (AppID).</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setAccounting()</h3>
        <p>Adds all the necessary attributes for the Accounting form.</p>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setAdmissions()</h3>
        <p>Adds all the necessary attributes for the Admissions form.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>tag</code></td>
                    <td>String</td>
                    <td>The agent-chosen tag for this application.</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: undefined</i></p>
        <p class="tip">There are multiple forms in the BYUI Tickets application.</p>
        <h3>setGeneralPartial()</h3>
        <p>Adds all the necessary attributes for part of BYUI Tickets, since a lot of forms use the same values.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>status?</code></td>
                    <td>Number</td>
                    <td>The status of the form; defaulted to open</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setGeneral()</h3>
        <p>Adds all the necessary attributes for the General form.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>tag</code></td>
                    <td>String</td>
                    <td>The agent-chosen tag for this application.</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setAdvising()</h3>
        <p>Adds all the necessary attributes for the Advising form.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>tag</code></td>
                    <td>String</td>
                    <td>The agent-chosen tag for this application.</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setFeedback()</h3>
        <p>Adds all the necessary attributes for the Course/Instructor Feedback form.</p>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setHealthCenter()</h3>
        <p>Adds all the necessary attributes for the Health Center form.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>tag</code></td>
                    <td>String</td>
                    <td>The agent-chosen tag for this application.</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setIT()</h3>
        <p>Adds all the necessary attributes for the IT form.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>tag</code></td>
                    <td>String</td>
                    <td>The agent-chosen tag for this application.</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setUniversityStore()</h3>
        <p>Adds all the necessary attributes for the University Store form.</p>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setSuspiciousContact()</h3>
        <p>Adds all the necessary attributes for the Suspicious Contact form.</p>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setFA()</h3>
        <p>Adds all the necessary attributes for the Financial Aid form.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>tag</code></td>
                    <td>String</td>
                    <td>The agent-chosen tag for this application.</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: undefined</i></p>
        <h3>setSRR()</h3>
        <p>Adds all the necessary attributes for the SRR form.</p>
        <table>
            <thead>
                <tr>
                    <th>Parameters</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>tag</code></td>
                    <td>String</td>
                    <td>The agent-chosen tag for this application.</td>
                </tr>
            </tbody>
        </table>
        <p class="tab"><i>Returns: undefined</i></p>
    </main>
    <script src="js/nav.js"></script>
</body>

</html>